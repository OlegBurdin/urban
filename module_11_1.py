import requests
import pandas
from pprint import pprint

URL = 'https://www.cbr-xml-daily.ru/daily_json.js'

"""
Использование модуля requests.
Получить данные о курсах валют с сайта на текущую дату и записать 
полученные данные в переменную r в формате json.
"""

r = requests.get(URL)
json_flag = False
if r.ok:
    try:
        r = r.json()
    except requests.exceptions.JSONDecodeError as e:
        print('Содержимое ответа не в формате json.', 'От источника был получен следующий ответ:',
              r, sep='\n')
    else:
        json_flag = True
pprint(r['Valute'])

"""
Использование модуля pandas.
Сохранить полученные курсы валют в файле .xlsx.
"""

if json_flag:
    # Формируем список валют для записи в файл
    field_list = ['CharCode', 'NumCode', 'Name', 'Nominal', 'Value']
    val_list = []
    for i in r['Valute']:
        line_ = []
        for j in field_list:
            line_.append(r['Valute'][i][j])
        val_list.append(line_)

    val_list.sort(key=lambda x: -x[3])
    pprint(val_list)

    # Сохраняем полученные данные в файл .xlsx
    df1 = pandas.DataFrame(val_list, columns=field_list)
    with pandas.ExcelWriter(f"val_{r['Date'][0:10]}.xlsx") as writer:
        df1.to_excel(writer, sheet_name=str(r['Date'][0:10]))
=>
"C:\Users\Asus Lap-Top\AppData\Local\Programs\Python\Python312\python.exe" D:\proj\pythonProjectUrban\module_11\module_11_1.py 
{'AED': {'CharCode': 'AED',
         'ID': 'R01230',
         'Name': 'Дирхам ОАЭ',
         'Nominal': 1,
         'NumCode': '784',
         'Previous': 27.6868,
         'Value': 27.8533},
 'AMD': {'CharCode': 'AMD',
         'ID': 'R01060',
         'Name': 'Армянских драмов',
         'Nominal': 100,
         'NumCode': '051',
         'Previous': 25.6456,
         'Value': 25.7758},
 'AUD': {'CharCode': 'AUD',
         'ID': 'R01010',
         'Name': 'Австралийский доллар',
         'Nominal': 1,
         'NumCode': '036',
         'Previous': 63.1533,
         'Value': 63.4103},
 'AZN': {'CharCode': 'AZN',
         'ID': 'R01020A',
         'Name': 'Азербайджанский манат',
         'Nominal': 1,
         'NumCode': '944',
         'Previous': 59.8116,
         'Value': 60.1712},
 'BGN': {'CharCode': 'BGN',
         'ID': 'R01100',
         'Name': 'Болгарский лев',
         'Nominal': 1,
         'NumCode': '975',
         'Previous': 54.2494,
         'Value': 53.7964},
 'BRL': {'CharCode': 'BRL',
         'ID': 'R01115',
         'Name': 'Бразильский реал',
         'Nominal': 1,
         'NumCode': '986',
         'Previous': 16.4031,
         'Value': 16.6821},
 'BYN': {'CharCode': 'BYN',
         'ID': 'R01090B',
         'Name': 'Белорусский рубль',
         'Nominal': 1,
         'NumCode': '933',
         'Previous': 29.6434,
         'Value': 29.378},
 'CAD': {'CharCode': 'CAD',
         'ID': 'R01350',
         'Name': 'Канадский доллар',
         'Nominal': 1,
         'NumCode': '124',
         'Previous': 70.5325,
         'Value': 71.0849},
 'CHF': {'CharCode': 'CHF',
         'ID': 'R01775',
         'Name': 'Швейцарский франк',
         'Nominal': 1,
         'NumCode': '756',
         'Previous': 112.9774,
         'Value': 112.2105},
 'CNY': {'CharCode': 'CNY',
         'ID': 'R01375',
         'Name': 'Юань',
         'Nominal': 1,
         'NumCode': '156',
         'Previous': 13.4272,
         'Value': 13.6934},
 'CZK': {'CharCode': 'CZK',
         'ID': 'R01760',
         'Name': 'Чешских крон',
         'Nominal': 10,
         'NumCode': '203',
         'Previous': 42.0912,
         'Value': 41.8728},
 'DKK': {'CharCode': 'DKK',
         'ID': 'R01215',
         'Name': 'Датская крона',
         'Nominal': 1,
         'NumCode': '208',
         'Previous': 14.2225,
         'Value': 14.1025},
 'EGP': {'CharCode': 'EGP',
         'ID': 'R01240',
         'Name': 'Египетских фунтов',
         'Nominal': 10,
         'NumCode': '818',
         'Previous': 19.9827,
         'Value': 20.226},
 'EUR': {'CharCode': 'EUR',
         'ID': 'R01239',
         'Name': 'Евро',
         'Nominal': 1,
         'NumCode': '978',
         'Previous': 106.1028,
         'Value': 105.0893},
 'GBP': {'CharCode': 'GBP',
         'ID': 'R01035',
         'Name': 'Фунт стерлингов',
         'Nominal': 1,
         'NumCode': '826',
         'Previous': 127.4962,
         'Value': 126.2477},
 'GEL': {'CharCode': 'GEL',
         'ID': 'R01210',
         'Name': 'Лари',
         'Nominal': 1,
         'NumCode': '981',
         'Previous': 36.3883,
         'Value': 36.0243},
 'HKD': {'CharCode': 'HKD',
         'ID': 'R01200',
         'Name': 'Гонконгский доллар',
         'Nominal': 1,
         'NumCode': '344',
         'Previous': 13.1225,
         'Value': 13.17},
 'HUF': {'CharCode': 'HUF',
         'ID': 'R01135',
         'Name': 'Форинтов',
         'Nominal': 100,
         'NumCode': '348',
         'Previous': 25.5214,
         'Value': 25.4766},
 'IDR': {'CharCode': 'IDR',
         'ID': 'R01280',
         'Name': 'Рупий',
         'Nominal': 10000,
         'NumCode': '360',
         'Previous': 62.7343,
         'Value': 63.1388},
 'INR': {'CharCode': 'INR',
         'ID': 'R01270',
         'Name': 'Индийских рупий',
         'Nominal': 10,
         'NumCode': '356',
         'Previous': 11.8797,
         'Value': 11.9109},
 'JPY': {'CharCode': 'JPY',
         'ID': 'R01820',
         'Name': 'Иен',
         'Nominal': 100,
         'NumCode': '392',
         'Previous': 64.3746,
         'Value': 64.6063},
 'KGS': {'CharCode': 'KGS',
         'ID': 'R01370',
         'Name': 'Сомов',
         'Nominal': 10,
         'NumCode': '417',
         'Previous': 11.6874,
         'Value': 11.7576},
 'KRW': {'CharCode': 'KRW',
         'ID': 'R01815',
         'Name': 'Вон',
         'Nominal': 1000,
         'NumCode': '410',
         'Previous': 69.5056,
         'Value': 70.3902},
 'KZT': {'CharCode': 'KZT',
         'ID': 'R01335',
         'Name': 'Тенге',
         'Nominal': 100,
         'NumCode': '398',
         'Previous': 19.486,
         'Value': 19.4016},
 'MDL': {'CharCode': 'MDL',
         'ID': 'R01500',
         'Name': 'Молдавских леев',
         'Nominal': 10,
         'NumCode': '498',
         'Previous': 55.0778,
         'Value': 55.5869},
 'NOK': {'CharCode': 'NOK',
         'ID': 'R01535',
         'Name': 'Норвежских крон',
         'Nominal': 10,
         'NumCode': '578',
         'Previous': 89.5872,
         'Value': 89.6378},
 'NZD': {'CharCode': 'NZD',
         'ID': 'R01530',
         'Name': 'Новозеландский доллар',
         'Nominal': 1,
         'NumCode': '554',
         'Previous': 57.1643,
         'Value': 57.2779},
 'PLN': {'CharCode': 'PLN',
         'ID': 'R01565',
         'Name': 'Злотый',
         'Nominal': 1,
         'NumCode': '985',
         'Previous': 24.7782,
         'Value': 24.6348},
 'QAR': {'CharCode': 'QAR',
         'ID': 'R01355',
         'Name': 'Катарский риал',
         'Nominal': 1,
         'NumCode': '634',
         'Previous': 27.934,
         'Value': 28.102},
 'RON': {'CharCode': 'RON',
         'ID': 'R01585F',
         'Name': 'Румынский лей',
         'Nominal': 1,
         'NumCode': '946',
         'Previous': 21.2862,
         'Value': 21.1919},
 'RSD': {'CharCode': 'RSD',
         'ID': 'R01805F',
         'Name': 'Сербских динаров',
         'Nominal': 100,
         'NumCode': '941',
         'Previous': 90.5031,
         'Value': 89.9962},
 'SEK': {'CharCode': 'SEK',
         'ID': 'R01770',
         'Name': 'Шведских крон',
         'Nominal': 10,
         'NumCode': '752',
         'Previous': 92.428,
         'Value': 91.3934},
 'SGD': {'CharCode': 'SGD',
         'ID': 'R01625',
         'Name': 'Сингапурский доллар',
         'Nominal': 1,
         'NumCode': '702',
         'Previous': 74.77,
         'Value': 74.7797},
 'THB': {'CharCode': 'THB',
         'ID': 'R01675',
         'Name': 'Батов',
         'Nominal': 10,
         'NumCode': '764',
         'Previous': 29.7989,
         'Value': 29.5008},
 'TJS': {'CharCode': 'TJS',
         'ID': 'R01670',
         'Name': 'Сомони',
         'Nominal': 10,
         'NumCode': '972',
         'Previous': 93.0026,
         'Value': 93.5036},
 'TMT': {'CharCode': 'TMT',
         'ID': 'R01710A',
         'Name': 'Новый туркменский манат',
         'Nominal': 1,
         'NumCode': '934',
         'Previous': 29.0513,
         'Value': 29.226},
 'TRY': {'CharCode': 'TRY',
         'ID': 'R01700J',
         'Name': 'Турецких лир',
         'Nominal': 10,
         'NumCode': '949',
         'Previous': 28.9122,
         'Value': 28.9369},
 'UAH': {'CharCode': 'UAH',
         'ID': 'R01720',
         'Name': 'Гривен',
         'Nominal': 10,
         'NumCode': '980',
         'Previous': 24.2993,
         'Value': 24.2189},
 'USD': {'CharCode': 'USD',
         'ID': 'R01235',
         'Name': 'Доллар США',
         'Nominal': 1,
         'NumCode': '840',
         'Previous': 101.6797,
         'Value': 102.2911},
 'UZS': {'CharCode': 'UZS',
         'ID': 'R01717',
         'Name': 'Узбекских сумов',
         'Nominal': 10000,
         'NumCode': '860',
         'Previous': 78.6965,
         'Value': 78.9102},
 'VND': {'CharCode': 'VND',
         'ID': 'R01150',
         'Name': 'Донгов',
         'Nominal': 10000,
         'NumCode': '704',
         'Previous': 41.8056,
         'Value': 42.0294},
 'XDR': {'CharCode': 'XDR',
         'ID': 'R01589',
         'Name': 'СДР (специальные права заимствования)',
         'Nominal': 1,
         'NumCode': '960',
         'Previous': 132.6035,
         'Value': 132.7186},
 'ZAR': {'CharCode': 'ZAR',
         'ID': 'R01810',
         'Name': 'Рэндов',
         'Nominal': 10,
         'NumCode': '710',
         'Previous': 54.1077,
         'Value': 54.0294}}
[['VND', '704', 'Донгов', 10000, 42.0294],
 ['IDR', '360', 'Рупий', 10000, 63.1388],
 ['UZS', '860', 'Узбекских сумов', 10000, 78.9102],
 ['KRW', '410', 'Вон', 1000, 70.3902],
 ['AMD', '051', 'Армянских драмов', 100, 25.7758],
 ['HUF', '348', 'Форинтов', 100, 25.4766],
 ['KZT', '398', 'Тенге', 100, 19.4016],
 ['RSD', '941', 'Сербских динаров', 100, 89.9962],
 ['JPY', '392', 'Иен', 100, 64.6063],
 ['EGP', '818', 'Египетских фунтов', 10, 20.226],
 ['INR', '356', 'Индийских рупий', 10, 11.9109],
 ['KGS', '417', 'Сомов', 10, 11.7576],
 ['MDL', '498', 'Молдавских леев', 10, 55.5869],
 ['NOK', '578', 'Норвежских крон', 10, 89.6378],
 ['TJS', '972', 'Сомони', 10, 93.5036],
 ['THB', '764', 'Батов', 10, 29.5008],
 ['TRY', '949', 'Турецких лир', 10, 28.9369],
 ['UAH', '980', 'Гривен', 10, 24.2189],
 ['CZK', '203', 'Чешских крон', 10, 41.8728],
 ['SEK', '752', 'Шведских крон', 10, 91.3934],
 ['ZAR', '710', 'Рэндов', 10, 54.0294],
 ['AUD', '036', 'Австралийский доллар', 1, 63.4103],
 ['AZN', '944', 'Азербайджанский манат', 1, 60.1712],
 ['GBP', '826', 'Фунт стерлингов', 1, 126.2477],
 ['BYN', '933', 'Белорусский рубль', 1, 29.378],
 ['BGN', '975', 'Болгарский лев', 1, 53.7964],
 ['BRL', '986', 'Бразильский реал', 1, 16.6821],
 ['HKD', '344', 'Гонконгский доллар', 1, 13.17],
 ['GEL', '981', 'Лари', 1, 36.0243],
 ['DKK', '208', 'Датская крона', 1, 14.1025],
 ['AED', '784', 'Дирхам ОАЭ', 1, 27.8533],
 ['USD', '840', 'Доллар США', 1, 102.2911],
 ['EUR', '978', 'Евро', 1, 105.0893],
 ['CAD', '124', 'Канадский доллар', 1, 71.0849],
 ['QAR', '634', 'Катарский риал', 1, 28.102],
 ['CNY', '156', 'Юань', 1, 13.6934],
 ['NZD', '554', 'Новозеландский доллар', 1, 57.2779],
 ['PLN', '985', 'Злотый', 1, 24.6348],
 ['RON', '946', 'Румынский лей', 1, 21.1919],
 ['XDR', '960', 'СДР (специальные права заимствования)', 1, 132.7186],
 ['SGD', '702', 'Сингапурский доллар', 1, 74.7797],
 ['TMT', '934', 'Новый туркменский манат', 1, 29.226],
 ['CHF', '756', 'Швейцарский франк', 1, 112.2105]]

Process finished with exit code 0

